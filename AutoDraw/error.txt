C:\Users\hira.asif\OneDrive - Astera Software\Documents\GitHub\AutoCAD-AI-Agent>python cli_autodraw.py --natural "Draw a 10-foot linear light with 1000 inches width 500 height and vertical orientation  from point 5,5 to 15,10 with 50W power and 4000K color temperature" --verbose
AutoDraw AI Agent - Command Line Interface
==================================================
2025-08-03 15:31:15,886 - INFO - Testing AutoCAD connection...
2025-08-03 15:31:15,903 - INFO - âœ… AutoCAD connection verified: AutoCAD
2025-08-03 15:31:15,907 - INFO - Processing natural language request
I am here P1
2025-08-03 15:31:15,916 - INFO - Connected to existing AutoCAD instance
2025-08-03 15:31:16,921 - INFO - Connected to AutoCAD: AutoCAD
2025-08-03 15:31:16,929 - INFO - Found 1 existing documents
2025-08-03 15:31:16,929 - INFO - Using active document
2025-08-03 15:31:16,951 - INFO - Successfully accessed ModelSpace
2025-08-03 15:31:16,951 - INFO - Successfully connected to AutoCAD
2025-08-03 15:31:16,953 - INFO - AutoDraw AI Agent initialized successfully
2025-08-03 15:31:17,575 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-f410ca23-972a-4e22-b4ad-b98e16bcd19e', 'json_data': {'messages': [{'role': 'system', 'content': 'You are an expert AutoCAD lighting design assistant. Parse user requests into structured specifications.'}, {'role': 'user', 'content': '\n        Parse this AutoCAD lighting design request into JSON format:\n        \n        User Request: "Draw a 10-foot linear light with 1000 inches width 500 height and vertical orientation  from point 5,5 to 15,10 with 50W power and 4000K color temperature"\n        \n        Available lighting systems: [\'ls\', \'lsr\', \'rush\', \'rush_rec\', \'pg\', \'magneto\']\n        Available mounting options: [\'wall_mount\', \'ceiling_mount\', \'suspension\', \'track_mount\', \'recessed\', \'surface_mount\', \'pendant\']\n        Available lens options: [\'clear\', \'frosted\', \'prismatic\', \'louvered\', \'reflector\', \'diffuser\', \'lens_cover\']\n        Available color temperatures: [\'2700k\', \'3000k\', \'3500k\', \'4000k\', \'5000k\', \'6500k\']\n        Available commands: [\'linear_light\', \'linear_light_reflector\', \'rush_light\', \'rush_recessed\', \'pg_light\', \'magneto_track\', \'repeat_last\', \'details\', \'add_empck\', \'output_modifier\', \'driver_calculator\', \'driver_update\', \'runid_update\', \'susp_kit_count\', \'ww_toggle\', \'import_assets\', \'redefine_blocks\', \'purge_all\']\n        \n        Return a JSON object with the following structure:\n        {\n            "command": "command_name",\n            "lighting_system": "system_type",\n            "dimensions": {\n                "length": "value_in_feet_or_meters",\n                "width": "value_in_inches_or_mm",\n                "height": "value_in_inches_or_mm"\n            },\n            "position": {\n                "start_point": [x, y, z],\n                "end_point": [x, y, z],\n                "orientation": "horizontal/vertical/angled"\n            },\n            "specifications": {\n                "wattage": "value_in_watts",\n                "color_temperature": "value_in_kelvin",\n                "lens_type": "lens_option",\n                "mounting_type": "mounting_option",\n                "driver_type": "driver_specification",\n                "quantity": "number_of_units"\n            },\n            "additional_parameters": {\n                "spacing": "distance_between_units",\n                "voltage": "voltage_requirement",\n                "emergency_backup": "true/false",\n                "dimmable": "true/false",\n                "ip_rating": "ingress_protection_rating"\n            }\n        }\n        \n        Extract all relevant information from the user request. If a value is not specified, use null.\n        Use standard units (feet for length, inches for width/height, watts for power, etc.).\n        '}], 'model': 'gpt-4', 'max_tokens': 1000, 'temperature': 0.1}}
2025-08-03 15:31:17,618 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-08-03 15:31:17,619 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-08-03 15:31:17,922 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001BD66FF3A90>
2025-08-03 15:31:17,922 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001BD66B02450> server_hostname='api.openai.com' timeout=5.0
2025-08-03 15:31:18,145 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001BD66FF3D10>
2025-08-03 15:31:18,145 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-08-03 15:31:18,148 - DEBUG - send_request_headers.complete
2025-08-03 15:31:18,151 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-08-03 15:31:18,152 - DEBUG - send_request_body.complete
2025-08-03 15:31:18,152 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-08-03 15:31:24,696 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sun, 03 Aug 2025 10:31:26 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'lexeme-vez7mp'), (b'openai-processing-ms', b'5892'), (b'openai-project', b'proj_WWQTNgSuMGy0E91SdczbpmAo'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'5913'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'1000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'999361'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'38ms'), (b'x-request-id', b'req_f955c955251a43edb616771a98b4e7e4'), (b'x-envoy-decorator-operation', b'router.openai.svc.cluster.local:5004/*'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=59lf8ZErO8XFo.Eh84v6XuNUpYqDeRQvw3cVJSztAP4-1754217086-1.0.1.1-WBBFhskCXBgOZBrytehR0U_1CiR87lc1JroEJDHRcDyo84Fng5HwRUDZWZb3Ba9t0x5TffXqTdrY1iF3x..Q4Iqr28sPxkQomDn998ZEyVA; path=/; expires=Sun, 03-Aug-25 11:01:26 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=8KEi5oqWI8eVskvnJUk4u3jnauNNhl4Yy6F4LQczM.s-1754217086228-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9695250d5e02b7d1-DEL'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-08-03 15:31:24,700 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-03 15:31:24,704 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-08-03 15:31:24,706 - DEBUG - receive_response_body.complete
2025-08-03 15:31:24,709 - DEBUG - response_closed.started
2025-08-03 15:31:24,710 - DEBUG - response_closed.complete
2025-08-03 15:31:24,711 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sun, 03 Aug 2025 10:31:26 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'lexeme-vez7mp'), ('openai-processing-ms', '5892'), ('openai-project', 'proj_WWQTNgSuMGy0E91SdczbpmAo'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '5913'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '1000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '999361'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '38ms'), ('x-request-id', 'req_f955c955251a43edb616771a98b4e7e4'), ('x-envoy-decorator-operation', 'router.openai.svc.cluster.local:5004/*'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=59lf8ZErO8XFo.Eh84v6XuNUpYqDeRQvw3cVJSztAP4-1754217086-1.0.1.1-WBBFhskCXBgOZBrytehR0U_1CiR87lc1JroEJDHRcDyo84Fng5HwRUDZWZb3Ba9t0x5TffXqTdrY1iF3x..Q4Iqr28sPxkQomDn998ZEyVA; path=/; expires=Sun, 03-Aug-25 11:01:26 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=8KEi5oqWI8eVskvnJUk4u3jnauNNhl4Yy6F4LQczM.s-1754217086228-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '9695250d5e02b7d1-DEL'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-08-03 15:31:24,713 - DEBUG - request_id: req_f955c955251a43edb616771a98b4e7e4
2025-08-03 15:31:24,731 - INFO - Parsed specifications: {'command': 'linear_light', 'lighting_system': None, 'dimensions': {'length': '10', 'width': '1000', 'height': '500'}, 'position': {'start_point': [5, 5, None], 'end_point': [15, 10, None], 'orientation': 'vertical'}, 'specifications': {'wattage': '50', 'color_temperature': '4000k', 'lens_type': None, 'mounting_type': None, 'driver_type': None, 'quantity': None}, 'additional_parameters': {'spacing': None, 'voltage': None, 'emergency_backup': None, 'dimmable': None, 'ip_rating': None}}

==================================================
DRAWING SPECIFICATIONS
==================================================
Command: linear_light
Lighting System: None

Dimensions:
  Length: 10 feet
  Width: 1000 inches
  Height: 500 inches

Position:
  Start: [5, 5, None]
  End: [15, 10, None]
  Orientation: vertical

Specifications:
  Wattage: 50W
  Color Temperature: 4000k
  Lens: None
  Mounting: None
  Quantity: None

Additional Parameters:
  Spacing: None
  Voltage: None
  Emergency Backup: None
  Dimmable: None
  Ip Rating: None
==================================================

2025-08-03 15:31:24,756 - INFO - Processing drawing request: {'command': 'linear_light', 'lighting_system': None, 'dimensions': {'length': '10', 'width': '1000', 'height': '500'}, 'position': {'start_point': [5, 5, None], 'end_point': [15, 10, None], 'orientation': 'vertical'}, 'specifications': {'wattage': '50', 'color_temperature': '4000k', 'lens_type': None, 'mounting_type': None, 'driver_type': None, 'quantity': None}, 'additional_parameters': {'spacing': None, 'voltage': None, 'emergency_backup': None, 'dimmable': None, 'ip_rating': None}}
2025-08-03 15:31:24,756 - INFO - Using provided specifications
2025-08-03 15:31:24,762 - INFO - Executing command: linear_light -> _LSAUTO
2025-08-03 15:31:24,764 - INFO - Executing AutoDraw command: linear_light
2025-08-03 15:31:24,764 - INFO - Full command: linear_light 5 5 15 10 10 1000 500 50 4000k
2025-08-03 15:31:25,715 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:25,883 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:26,163 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:26,471 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:26,676 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:26,942 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:27,186 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:27,496 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:27,807 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:28,191 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:28,503 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:28,753 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:29,060 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:29,371 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:29,679 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:29,912 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:30,224 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:30,533 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:30,794 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:31,090 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:31,338 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:31,708 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:31,879 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:32,173 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:32,392 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:32,719 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:32,905 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:33,198 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:33,434 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:33,743 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:33,946 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:34,207 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:34,454 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:34,749 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:35,073 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:35,386 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:35,524 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:35,851 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:36,058 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:36,320 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:36,568 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:36,861 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:37,092 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:37,418 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:37,650 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:37,964 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:38,150 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:38,429 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:38,675 - ERROR - Error waiting for command completion: <unknown>.CommandInProgress
2025-08-03 15:31:38,968 - ERROR - Error waiting for command completion: 
2025-08-03 15:32:13,038 - WARNING - Command execution timeout
2025-08-03 15:32:13,038 - INFO - Successfully executed linear_light
âœ… Drawing created successfully!
Summary: Created None drawing:
- Dimensions: 10 x 1000 x 500
- Wattage: 50W
- Color Temperature: 4000k
- Quantity: None

ðŸŽ‰ Process completed successfully!
2025-08-03 15:32:13,162 - INFO - AutoCAD connection closed
2025-08-03 15:32:13,190 - DEBUG - close.started
2025-08-03 15:32:13,191 - DEBUG - close.complete

C:\Users\hira.asif\OneDrive - Astera Software\Documents\GitHub\AutoCAD-AI-Agent>






































